sudo: required
dist: trusty

language: node_js
cache: 
  - npm

notifications:
  email:
    on_success: never
    on_failure: change

matrix:
  include:
    - os: linux
      node_js: lts/*

before_install:
  - npm i -g firebase-tools

install:
  - npm install

script:
  - npm run cloud-build
  - npm run post-build

deploy:
  provider: gcs
  access_key_id: "GCS Interoperable Access Key ID"
  secret_access_key: "GCS Interoperable Access Secret"
  bucket: "GCS Bucket"
  skip_cleanup: true

after_deploy:
  - npm run ssn